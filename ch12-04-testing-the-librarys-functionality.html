<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ğŸ‡§ğŸ‡· Desenvolvendo a Biblioteca de Funcionalidades - A linguagem de programaÃ§Ã£o Rust</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="title-page.html">ğŸ‡§ğŸ‡· A linguagem de programaÃ§Ã£o Rust</a></li><li class="chapter-item expanded affix "><a href="foreword.html">ğŸ‡§ğŸ‡· PrefÃ¡cio</a></li><li class="chapter-item expanded affix "><a href="ch00-00-introduction.html">ğŸ‡§ğŸ‡· IntroduÃ§Ã£o</a></li><li class="chapter-item expanded "><a href="ch01-00-getting-started.html"><strong aria-hidden="true">1.</strong> ğŸ‡§ğŸ‡· ComeÃ§ando</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch01-01-installation.html"><strong aria-hidden="true">1.1.</strong> ğŸ‡§ğŸ‡· InstalaÃ§Ã£o</a></li><li class="chapter-item expanded "><a href="ch01-02-hello-world.html"><strong aria-hidden="true">1.2.</strong> ğŸ‡§ğŸ‡· OlÃ¡, Mundo!</a></li><li class="chapter-item expanded "><a href="ch01-03-hello-cargo.html"><strong aria-hidden="true">1.3.</strong> ğŸ‡§ğŸ‡· OlÃ¡, Cargo!</a></li></ol></li><li class="chapter-item expanded "><a href="ch02-00-guessing-game-tutorial.html"><strong aria-hidden="true">2.</strong> ğŸ‡§ğŸ‡· Jogo de AdivinhaÃ§Ã£o</a></li><li class="chapter-item expanded "><a href="ch03-00-common-programming-concepts.html"><strong aria-hidden="true">3.</strong> ğŸ‡§ğŸ‡· Conceitos Comuns de ProgramaÃ§Ã£o</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch03-01-variables-and-mutability.html"><strong aria-hidden="true">3.1.</strong> ğŸ‡§ğŸ‡· VariÃ¡veis e Mutabilidade</a></li><li class="chapter-item expanded "><a href="ch03-02-data-types.html"><strong aria-hidden="true">3.2.</strong> ğŸ‡§ğŸ‡· Tipos de dados</a></li><li class="chapter-item expanded "><a href="ch03-03-how-functions-work.html"><strong aria-hidden="true">3.3.</strong> ğŸ‡§ğŸ‡· FunÃ§Ãµes</a></li><li class="chapter-item expanded "><a href="ch03-04-comments.html"><strong aria-hidden="true">3.4.</strong> ğŸ‡§ğŸ‡· ComentÃ¡rios</a></li><li class="chapter-item expanded "><a href="ch03-05-control-flow.html"><strong aria-hidden="true">3.5.</strong> ğŸ‡§ğŸ‡· Controle de fluxo</a></li></ol></li><li class="chapter-item expanded "><a href="ch04-00-understanding-ownership.html"><strong aria-hidden="true">4.</strong> ğŸ‡§ğŸ‡· Entendendo Ownership</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch04-01-what-is-ownership.html"><strong aria-hidden="true">4.1.</strong> ğŸ‡§ğŸ‡· O Que Ã‰ Ownership?</a></li><li class="chapter-item expanded "><a href="ch04-02-references-and-borrowing.html"><strong aria-hidden="true">4.2.</strong> ğŸ‡§ğŸ‡· ReferÃªncias e Borrowing</a></li><li class="chapter-item expanded "><a href="ch04-03-slices.html"><strong aria-hidden="true">4.3.</strong> ğŸ‡§ğŸ‡· Slices</a></li></ol></li><li class="chapter-item expanded "><a href="ch05-00-structs.html"><strong aria-hidden="true">5.</strong> ğŸ‡§ğŸ‡· Usando Structs para Estruturar Dados Relacionados</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-01-defining-structs.html"><strong aria-hidden="true">5.1.</strong> ğŸ‡§ğŸ‡· Definindo e Instanciando Structs</a></li><li class="chapter-item expanded "><a href="ch05-02-example-structs.html"><strong aria-hidden="true">5.2.</strong> ğŸ‡§ğŸ‡· Um Exemplo de um Programa que usa Structs</a></li><li class="chapter-item expanded "><a href="ch05-03-method-syntax.html"><strong aria-hidden="true">5.3.</strong> ğŸ‡§ğŸ‡· Sintaxe do MÃ©todo</a></li></ol></li><li class="chapter-item expanded "><a href="ch06-00-enums.html"><strong aria-hidden="true">6.</strong> ğŸ‡§ğŸ‡· Enums e Casamento de PadrÃµes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch06-01-defining-an-enum.html"><strong aria-hidden="true">6.1.</strong> ğŸ‡§ğŸ‡· Definindo uma Enum</a></li><li class="chapter-item expanded "><a href="ch06-02-match.html"><strong aria-hidden="true">6.2.</strong> ğŸ‡§ğŸ‡· Operador match</a></li><li class="chapter-item expanded "><a href="ch06-03-if-let.html"><strong aria-hidden="true">6.3.</strong> ğŸ‡§ğŸ‡· Controle de Fluxo Conciso com if let</a></li></ol></li><li class="chapter-item expanded "><a href="ch07-00-modules.html"><strong aria-hidden="true">7.</strong> ğŸ‡§ğŸ‡· MÃ³dulos</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch07-01-mod-and-the-filesystem.html"><strong aria-hidden="true">7.1.</strong> ğŸ‡§ğŸ‡· mod e o Sistema de Arquivos</a></li><li class="chapter-item expanded "><a href="ch07-02-controlling-visibility-with-pub.html"><strong aria-hidden="true">7.2.</strong> ğŸ‡§ğŸ‡· Controlando a Visibilidade com pub</a></li><li class="chapter-item expanded "><a href="ch07-03-importing-names-with-use.html"><strong aria-hidden="true">7.3.</strong> ğŸ‡§ğŸ‡· Importando nomes com use</a></li></ol></li><li class="chapter-item expanded "><a href="ch08-00-common-collections.html"><strong aria-hidden="true">8.</strong> ğŸ‡§ğŸ‡· ColeÃ§Ãµes comuns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch08-01-vectors.html"><strong aria-hidden="true">8.1.</strong> ğŸ‡§ğŸ‡· Vetores</a></li><li class="chapter-item expanded "><a href="ch08-02-strings.html"><strong aria-hidden="true">8.2.</strong> ğŸ‡§ğŸ‡· Strings</a></li><li class="chapter-item expanded "><a href="ch08-03-hash-maps.html"><strong aria-hidden="true">8.3.</strong> ğŸ‡§ğŸ‡· Hash Maps</a></li></ol></li><li class="chapter-item expanded "><a href="ch09-00-error-handling.html"><strong aria-hidden="true">9.</strong> ğŸ‡§ğŸ‡· Tratamento de Erros</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch09-01-unrecoverable-errors-with-panic.html"><strong aria-hidden="true">9.1.</strong> ğŸ‡§ğŸ‡· Erros IrrecuperÃ¡veis com panic!</a></li><li class="chapter-item expanded "><a href="ch09-02-recoverable-errors-with-result.html"><strong aria-hidden="true">9.2.</strong> ğŸ‡§ğŸ‡· Erros recuperÃ¡veis com Result</a></li><li class="chapter-item expanded "><a href="ch09-03-to-panic-or-not-to-panic.html"><strong aria-hidden="true">9.3.</strong> ğŸ‡§ğŸ‡· Entrar em panic! ou NÃ£o Entrar em panic!</a></li></ol></li><li class="chapter-item expanded "><a href="ch10-00-generics.html"><strong aria-hidden="true">10.</strong> ğŸ‡§ğŸ‡· Tipos GenÃ©ricos, Traits, e Tempos de vida (Lifetimes)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch10-01-syntax.html"><strong aria-hidden="true">10.1.</strong> ğŸ‡§ğŸ‡· Tipos GenÃ©ricos de Dados</a></li><li class="chapter-item expanded "><a href="ch10-02-traits.html"><strong aria-hidden="true">10.2.</strong> ğŸ‡§ğŸ‡· Traits: Definindo Comportamento Compartilhado</a></li><li class="chapter-item expanded "><a href="ch10-03-lifetime-syntax.html"><strong aria-hidden="true">10.3.</strong> ğŸ‡§ğŸ‡· Validating References with Lifetimes</a></li></ol></li><li class="chapter-item expanded "><a href="ch11-00-testing.html"><strong aria-hidden="true">11.</strong> Testing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch11-01-writing-tests.html"><strong aria-hidden="true">11.1.</strong> Writing tests</a></li><li class="chapter-item expanded "><a href="ch11-02-running-tests.html"><strong aria-hidden="true">11.2.</strong> Running tests</a></li><li class="chapter-item expanded "><a href="ch11-03-test-organization.html"><strong aria-hidden="true">11.3.</strong> Test Organization</a></li></ol></li><li class="chapter-item expanded "><a href="ch12-00-an-io-project.html"><strong aria-hidden="true">12.</strong> ğŸ‡§ğŸ‡· Um projeto de E/S</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch12-01-accepting-command-line-arguments.html"><strong aria-hidden="true">12.1.</strong> ğŸ‡§ğŸ‡· Aceitando Argumentos em Linha de Comando</a></li><li class="chapter-item expanded "><a href="ch12-02-reading-a-file.html"><strong aria-hidden="true">12.2.</strong> ğŸ‡§ğŸ‡· Lendo um Arquivo</a></li><li class="chapter-item expanded "><a href="ch12-03-improving-error-handling-and-modularity.html"><strong aria-hidden="true">12.3.</strong> ğŸ‡§ğŸ‡· RefatoraÃ§Ã£o para Melhorar a Modularidade e o Tratamento de Erros</a></li><li class="chapter-item expanded "><a href="ch12-04-testing-the-librarys-functionality.html" class="active"><strong aria-hidden="true">12.4.</strong> ğŸ‡§ğŸ‡· Desenvolvendo a Biblioteca de Funcionalidades</a></li><li class="chapter-item expanded "><a href="ch12-05-working-with-environment-variables.html"><strong aria-hidden="true">12.5.</strong> ğŸ‡§ğŸ‡· Trabalhando com VariÃ¡veis de Ambiente</a></li><li class="chapter-item expanded "><a href="ch12-06-writing-to-stderr-instead-of-stdout.html"><strong aria-hidden="true">12.6.</strong> ğŸ‡§ğŸ‡· Escrevendo Mensagens de Erro para Erro PadrÃ£o em Vez de SaÃ­da PadrÃ£o</a></li></ol></li><li class="chapter-item expanded "><a href="ch13-00-functional-features.html"><strong aria-hidden="true">13.</strong> Functional Language Features in Rust</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch13-01-closures.html"><strong aria-hidden="true">13.1.</strong> Closures</a></li><li class="chapter-item expanded "><a href="ch13-02-iterators.html"><strong aria-hidden="true">13.2.</strong> Iterators</a></li><li class="chapter-item expanded "><a href="ch13-03-improving-our-io-project.html"><strong aria-hidden="true">13.3.</strong> Improving our I/O Project</a></li><li class="chapter-item expanded "><a href="ch13-04-performance.html"><strong aria-hidden="true">13.4.</strong> Performance</a></li></ol></li><li class="chapter-item expanded "><a href="ch14-00-more-about-cargo.html"><strong aria-hidden="true">14.</strong> More about Cargo and Crates.io</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch14-01-release-profiles.html"><strong aria-hidden="true">14.1.</strong> Release Profiles</a></li><li class="chapter-item expanded "><a href="ch14-02-publishing-to-crates-io.html"><strong aria-hidden="true">14.2.</strong> Publishing a Crate to Crates.io</a></li><li class="chapter-item expanded "><a href="ch14-03-cargo-workspaces.html"><strong aria-hidden="true">14.3.</strong> Cargo Workspaces</a></li><li class="chapter-item expanded "><a href="ch14-04-installing-binaries.html"><strong aria-hidden="true">14.4.</strong> Installing Binaries from Crates.io with cargo install</a></li><li class="chapter-item expanded "><a href="ch14-05-extending-cargo.html"><strong aria-hidden="true">14.5.</strong> Extending Cargo with Custom Commands</a></li></ol></li><li class="chapter-item expanded "><a href="ch15-00-smart-pointers.html"><strong aria-hidden="true">15.</strong> ğŸ‡§ğŸ‡· Ponteiros Inteligentes (Smart Pointers)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch15-01-box.html"><strong aria-hidden="true">15.1.</strong> ğŸ‡§ğŸ‡· Box<T> Aponta para Dados no Heap e Tem Tamanho Conhecido</a></li><li class="chapter-item expanded "><a href="ch15-02-deref.html"><strong aria-hidden="true">15.2.</strong> ğŸ‡§ğŸ‡· Tratando Ponteiros Inteligentes como ReferÃªncias Normais com a Trait Deref</a></li><li class="chapter-item expanded "><a href="ch15-03-drop.html"><strong aria-hidden="true">15.3.</strong> ğŸ‡§ğŸ‡· A Trait Drop Roda CÃ³digo durante a Limpeza</a></li><li class="chapter-item expanded "><a href="ch15-04-rc.html"><strong aria-hidden="true">15.4.</strong> ğŸ‡§ğŸ‡· Rc<T>, o Ponteiro Inteligente com Contagem de ReferÃªncias</a></li><li class="chapter-item expanded "><a href="ch15-05-interior-mutability.html"><strong aria-hidden="true">15.5.</strong> ğŸ‡§ğŸ‡· RefCell<T> e a Pattern de Mutabilidade Interior</a></li><li class="chapter-item expanded "><a href="ch15-06-reference-cycles.html"><strong aria-hidden="true">15.6.</strong> ğŸ‡§ğŸ‡· Ciclos de ReferÃªncias Podem Vazar MemÃ³ria</a></li></ol></li><li class="chapter-item expanded "><a href="ch16-00-concurrency.html"><strong aria-hidden="true">16.</strong> Concurrency</a></li><li class="chapter-item expanded "><a href="ch17-00-oop.html"><strong aria-hidden="true">17.</strong> ğŸ‡§ğŸ‡· Rust Ã© uma linguagem orientada a objetos?</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch17-01-oo.html"><strong aria-hidden="true">17.1.</strong> ğŸ‡§ğŸ‡· O que significa orientado a objetos?</a></li><li class="chapter-item expanded "><a href="ch17-02-trait-objects.html"><strong aria-hidden="true">17.2.</strong> ğŸ‡§ğŸ‡· Usando objetos trait que permitem valores de tipos diferentes</a></li><li class="chapter-item expanded "><a href="ch17-03-oo-design-patterns.html"><strong aria-hidden="true">17.3.</strong> ğŸ‡§ğŸ‡· Implementando um padrÃ£o de projeto orientado a objetos</a></li></ol></li><li class="chapter-item expanded "><a href="ch18-00-patterns.html"><strong aria-hidden="true">18.</strong> Patterns</a></li><li class="chapter-item expanded "><a href="ch19-00-more-lifetimes.html"><strong aria-hidden="true">19.</strong> More Lifetimes</a></li><li class="chapter-item expanded "><a href="ch20-00-advanced-types.html"><strong aria-hidden="true">20.</strong> Advanced Type System Features</a></li><li class="chapter-item expanded "><a href="appendix-00.html"><strong aria-hidden="true">21.</strong> Appendix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="appendix-01-keywords.html"><strong aria-hidden="true">21.1.</strong> Keywords</a></li><li class="chapter-item expanded "><a href="appendix-02-operators.html"><strong aria-hidden="true">21.2.</strong> Operators</a></li><li class="chapter-item expanded "><a href="appendix-03-derivable-traits.html"><strong aria-hidden="true">21.3.</strong> Derivable Traits</a></li><li class="chapter-item expanded "><a href="appendix-04-nightly-rust.html"><strong aria-hidden="true">21.4.</strong> Nightly Rust</a></li><li class="chapter-item expanded "><a href="appendix-05-macros.html"><strong aria-hidden="true">21.5.</strong> Macros</a></li><li class="chapter-item expanded "><a href="appendix-07-nightly-rust.html"><strong aria-hidden="true">21.6.</strong> ğŸ‡§ğŸ‡· G - Como Ã© feito o Rust e o &quot;Rust Nightly&quot;</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">A linguagem de programaÃ§Ã£o Rust</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2><a class="header" href="#desenvolvendo-a-biblioteca-de-funcionalidades-com-desenvolvimento-guiado-por-testes" id="desenvolvendo-a-biblioteca-de-funcionalidades-com-desenvolvimento-guiado-por-testes">Desenvolvendo a Biblioteca de Funcionalidades com Desenvolvimento Guiado por Testes</a></h2>
<p>Agora que extraÃ­mos a lÃ³gica em <em>src/lib.rs</em> e deixamos o argumento de
coleta e tratamento de erros em <em>src/main.rs</em>, Ã© muito mais fÃ¡cil escrever testes
para nosso cÃ³digo da funcionalidade principal. Podemos chamar funÃ§Ãµes diretamente com
vÃ¡rios argumentos e verificar valores de retorno sem ter que chamar o nosso binÃ¡rio
da linha de comando. Sinta-se livre para escrever alguns testes para 
as funÃ§Ãµes <code>Config::new</code> e <code>run</code> por sua conta.</p>
<p>Nesta seÃ§Ã£o, adicionaremos a lÃ³gica de busca ao programa <code>minigrep</code>
usando o processo Desenvolvimento Guiado por Testes (Test Driven Development (TDD)). 
Nessa tÃ©cnica de desenvolvimento de software, segue estas etapas:</p>
<ol>
<li>Escreva um teste que falha e execute-o, para certificar-se de que ele falha pelo motivo 
Â Â Â  esperado por vocÃª.</li>
<li>Escreva ou modifique o cÃ³digo apenas o suficiente para fazer passar no teste.</li>
<li>Refatore o cÃ³digo que vocÃª acabou de adicionar ou alterou e certifique-se de que os testes
Â Â Â  continuam a passar.</li>
<li>Repita a partir do passo 1!</li>
</ol>
<p>Este processo Ã© apenas uma das muitas maneiras de escrever software, mas o TDD pode ajudar a conduzir
design de cÃ³digo tambÃ©m. Escrevendo o teste antes de escrever o cÃ³digo que faz o
teste passar, ajuda a manter uma alta cobertura de teste ao longo do processo.</p>
<p>Testaremos a implementaÃ§Ã£o da funcionalidade que realmente farÃ¡
a busca da string de consulta no conteÃºdo do arquivo, e produzir uma lista de
linhas que correspondem Ã  consulta. Vamos adicionar essa funcionalidade em uma funÃ§Ã£o chamada
<code>search</code>.</p>
<h3><a class="header" href="#escrevendo-um-teste-de-falha" id="escrevendo-um-teste-de-falha">Escrevendo um Teste de Falha</a></h3>
<p>Porque nÃ£o precisamos mais deles, vamos remover as instruÃ§Ãµes <code>println!</code> de
<em>src/lib.rs</em> e <em>src/main.rs</em> que costumÃ¡vamos verificar o comportamento do programa.
EntÃ£o, em <em>src/lib.rs</em>, adicionaremos um mÃ³dulo <code>test</code> com uma funÃ§Ã£o de teste, como nÃ³s
fizemos no CapÃ­tulo 11. A funÃ§Ã£o de teste especifica o comportamento que queremos
para a funÃ§Ã£o <code>search</code> tenha: receberÃ¡ os parÃ¢metros da consulta e o texto para realizar a
consulta, e retornarÃ¡ apenas as linhas do texto que contÃ©m a consulta.
A Listagem 12-15 mostra esse teste, que ainda nÃ£o compilarÃ¡:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span><span class="boring">fn search&lt;'a&gt;(query: &amp;str, contents: &amp;'a str) -&gt; Vec&lt;&amp;'a str&gt; {
</span><span class="boring">     vec![]
</span><span class="boring">}
</span><span class="boring">
</span>#[cfg(test)]
mod test {
    use super::*;

    #[test]
    fn one_result() {
        let query = &quot;duct&quot;;
        let contents = &quot;\
Rust:
safe, fast, productive.
Pick three.&quot;;

        assert_eq!(
            vec![&quot;safe, fast, productive.&quot;],
            search(query, contents)
        );
    }
}
<span class="boring">}
</span></code></pre></pre>
<p><span class="caption">Listagem 12-15: Criando um teste de falha para a funÃ§Ã£o <code>search</code>
que desejamos ter</span></p>
<p>Este teste procura a string â€œductâ€. O texto que estamos procurando contÃ©m trÃªs
linhas, apenas uma das quais contÃ©m â€œduct.â€ Afirmamos que o valor retornado
a partir da funÃ§Ã£o <code>search</code> contÃ©m apenas a linha que esperamos.</p>
<p>NÃ£o somos capazes de executar este teste e vÃª-lo falhar porque o teste nem mesmo
compila: a funÃ§Ã£o <code>search</code> ainda nÃ£o existe! EntÃ£o, agora vamos adicionar cÃ³digo apenas o suficiente
para obter a compilaÃ§Ã£o do teste, e executar, adicionando uma definiÃ§Ã£o da funÃ§Ã£o <code>search</code>
que sempre retorna um vetor vazio, como mostrado na Listagem 12-16. EntÃ£o
o teste deve compilar e falhar porque um vetor vazio nÃ£o corresponde a um vetor
contendo a linha <code>&quot;safe, fast, productive.&quot;</code>.</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn search&lt;'a&gt;(query: &amp;str, contents: &amp;'a str) -&gt; Vec&lt;&amp;'a str&gt; {
    vec![]
}
<span class="boring">}
</span></code></pre></pre>
<p><span class="caption">Listagem 12-16: Definindo apenas o suficiente da funÃ§Ã£o <code>search</code>
para que nosso teste compile</span></p>
<p>Observe que precisamos de uma lifetime explÃ­cita <code>'a</code> definida na assinatura do
<code>search</code> e usada com o argumento <code>contents</code> e o valor de retorno. Lembre-se no
CapÃ­tulo 10 que os parÃ¢metros de lifetime especificam qual o lifetime do argumento
conectado ao lifetime do valor de retorno. Neste caso, indicamos que
o vetor retornado deve conter pedaÃ§os de string que fazem referÃªncia a pedaÃ§os do
argumento <code>contents</code> (em vez do argumento <code>query</code>).</p>
<p>Em outras palavras, dizemos ao Rust que os dados retornados pela funÃ§Ã£o <code>search</code>
irÃ¡ viver enquanto os dados passarem para a funÃ§Ã£o <code>search</code> no
argumento de <code>contents</code>. Isso Ã© importante! Os dados referenciados <em>por</em> um pedaÃ§o precisa
ser vÃ¡lido para que a referÃªncia seja vÃ¡lida; se o compilador assume que estamos fazendo
pedaÃ§os de string de <code>query</code> em vez de <code>contents</code>, ele farÃ¡ sua verificaÃ§Ã£o de seguranÃ§a
incorretamente.</p>
<p>Se esquecermos as anotaÃ§Ãµes de lifetime e tentarmos compilar esta funÃ§Ã£o, iremos
obter este erro:</p>
<pre><code class="language-text">error[E0106]: missing lifetime specifier
 --&gt; src/lib.rs:5:51
  |
5 | pub fn search(query: &amp;str, contents: &amp;str) -&gt; Vec&lt;&amp;str&gt; {
  |                                                   ^ expected lifetime
parameter
  |
  = help: this function's return type contains a borrowed value, but the
  signature does not say whether it is borrowed from `query` or `contents`
</code></pre>
<p>Rust nÃ£o consegue saber qual dos dois argumentos que precisamos, entÃ£o precisamos informar
isto. Porque <code>contents</code> Ã© o argumento que contÃ©m todo o nosso texto e nÃ³s
queremos retornar as partes desse texto que combinam, sabemos que o <code>contents</code> Ã© o
argumento que deve ser conectado ao valor de retorno usando a sintaxe de lifetime.</p>
<p>Outras linguagens de programaÃ§Ã£o nÃ£o exigem que vocÃª conecte argumentos para retornar
valores na assinatura, por isso, embora isso possa parecer estranho, ele ficarÃ¡
mais fÃ¡cil ao longo do tempo. VocÃª pode querer comparar este exemplo com a seÃ§Ã£o â€œValidando
ReferÃªncias com Lifetimesâ€ no CapÃ­tulo 10.</p>
<p>Agora vamos executar o teste:</p>
<pre><code class="language-text">$ cargo test
   Compiling minigrep v0.1.0 (file:///projects/minigrep)
--warnings--
    Finished dev [unoptimized + debuginfo] target(s) in 0.43 secs
     Running target/debug/deps/minigrep-abcabcabc

running 1 test
test test::one_result ... FAILED

failures:

---- test::one_result stdout ----
        thread 'test::one_result' panicked at 'assertion failed: `(left ==
right)`
left: `[&quot;safe, fast, productive.&quot;]`,
right: `[]`)', src/lib.rs:48:8
note: Run with `RUST_BACKTRACE=1` for a backtrace.


failures:
    test::one_result

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out

error: test failed, to rerun pass '--lib'
</code></pre>
<p>Ã“timo, o teste falha, exatamente como esperÃ¡vamos. Vamos fazer o teste passar!</p>
<h3><a class="header" href="#escrevendo-cÃ³digo-para-passar-no-teste" id="escrevendo-cÃ³digo-para-passar-no-teste">Escrevendo CÃ³digo para Passar no Teste</a></h3>
<p>Atualmente, nosso teste estÃ¡ falhando porque sempre devolvemos um vetor vazio. Para consertar 
isso Ã© preciso implementar <code>search</code>, nosso programa precisa seguir essas etapas:</p>
<ul>
<li>Iterar atravÃ©s de cada linha do conteÃºdo.</li>
<li>Verificar se a linha contÃ©m nossa string de consulta.</li>
<li>Se a tiver, adicione-a Ã  lista de valores que estamos retornando.</li>
<li>Se nÃ£o, nÃ£o faÃ§a nada.</li>
<li>Retorna a lista de resultados que correspondem.</li>
</ul>
<p>Vamos trabalhar em cada passo, comeÃ§ando por iterar atravÃ©s de linhas.</p>
<h4><a class="header" href="#iterar-atravÃ©s-de-linhas-com-o-mÃ©todo-lines" id="iterar-atravÃ©s-de-linhas-com-o-mÃ©todo-lines">Iterar AtravÃ©s de Linhas com o MÃ©todo <code>lines</code></a></h4>
<p>Rust tem um mÃ©todo Ãºtil para lidar com a iteraÃ§Ã£o linha-a-linha de strings,
convenientemente chamado <code>lines</code>, que funciona como mostrado na Listagem 12-17. Observe que isso
ainda nÃ£o compilarÃ¡:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><code class="language-rust ignore">pub fn search&lt;'a&gt;(query: &amp;str, contents: &amp;'a str) -&gt; Vec&lt;&amp;'a str&gt; {
    for line in contents.lines() {
        // faÃ§a algo com line
    }
}
</code></pre>
<p><span class="caption">Listagem 12-17: Iterando para cada linha em <code>contents</code>
</span></p>
<p>O mÃ©todo <code>lines</code> retorna um iterador. Vamos falar sobre iteradores em profundidade no
CapÃ­tulo 13, mas lembre-se de que vocÃª viu essa maneira de usar um iterador na Listagem
3-4, onde usamos um loop <code>for</code> com um iterador para executar algum cÃ³digo em cada item
de uma coleÃ§Ã£o.</p>
<h4><a class="header" href="#pesquisando-cada-linha-para-a-consulta" id="pesquisando-cada-linha-para-a-consulta">Pesquisando Cada Linha para a Consulta</a></h4>
<p>Em seguida, verificamos se a linha atual contÃ©m nossa string de consulta.
Felizmente, as strings possuem um mÃ©todo Ãºtil chamado <code>contains</code> que faz isso para
nÃ³s! Adicione uma chamada ao mÃ©todo <code>contains</code> na funÃ§Ã£o <code>search</code>, conforme mostrado na
Listagem 12-18. Observe que isso ainda nÃ£o compilarÃ¡ ainda:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><code class="language-rust ignore">pub fn search&lt;'a&gt;(query: &amp;str, contents: &amp;'a str) -&gt; Vec&lt;&amp;'a str&gt; {
    for line in contents.lines() {
        if line.contains(query) {
            // do something with line
        }
    }
}
</code></pre>
<p><span class="caption">Listagem 12-18: Adicionando funcionalidade para ver se
a linha contÃ©m a string na <code>query</code></span></p>
<h4><a class="header" href="#armazenamento-de-linhas-correspondentes" id="armazenamento-de-linhas-correspondentes">Armazenamento de Linhas Correspondentes</a></h4>
<p>NÃ³s tambÃ©m precisamos de uma maneira de armazenar as linhas que contÃªm nossa string de consulta. Por isso,
podemos fazer um vetor mutÃ¡vel antes do loop <code>for</code> e chamar o mÃ©todo <code>push</code>
para armazenar uma <code>line</code> no vetor. ApÃ³s o loop <code>for</code>, devolvemos o vetor, como
mostrado na Listagem 12-19:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><code class="language-rust ignore">pub fn search&lt;'a&gt;(query: &amp;str, contents: &amp;'a str) -&gt; Vec&lt;&amp;'a str&gt; {
    let mut results = Vec::new();

    for line in contents.lines() {
        if line.contains(query) {
            results.push(line);
        }
    }

    results
}
</code></pre>
<p><span class="caption">Listagem 12-19: Armazenando as linhas que combinam para que possamos
devolvÃª-las</span></p>
<p>Agora, a funÃ§Ã£o <code>search</code> deve retornar apenas as linhas que contÃªm<code> query</code>,
e nosso teste deve passar. Vamos executar o teste:</p>
<pre><code class="language-text">$ cargo test
--snip--
running 1 test
test test::one_result ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out
</code></pre>
<p>Nosso teste passou, entÃ£o sabemos que funciona!</p>
<p>Neste ponto, poderÃ­amos considerar oportunidades de refatorar
a implementaÃ§Ã£o da funÃ§Ã£o de pesquisa, mantendo os testes passando para
a mesma funcionalidade. O cÃ³digo na funÃ§Ã£o de pesquisa nÃ£o Ã© muito ruim,
mas nÃ£o tira proveito de algumas caracterÃ­sticas Ãºteis dos iteradores. Iremos
voltar para este exemplo no CapÃ­tulo 13, onde exploraremos iteradores em detalhes
e veremos como melhorÃ¡-lo.</p>
<h4><a class="header" href="#usando-a-funÃ§Ã£o-search-na-funÃ§Ã£o-run" id="usando-a-funÃ§Ã£o-search-na-funÃ§Ã£o-run">Usando a FunÃ§Ã£o <code>search</code> na FunÃ§Ã£o<code> run</code></a></h4>
<p>Agora que a funÃ§Ã£o <code>search</code> estÃ¡ funcionando e testada, precisamos chamar <code>search</code>
da nossa funÃ§Ã£o <code>run</code>. Precisamos passar o valor <code>config.query</code> e o 
<code>contents</code> que <code>run</code> lÃª do arquivo para a funÃ§Ã£o <code>search</code>. EntÃ£o, <code>run</code>
irÃ¡ imprimir cada linha retornada de <code>search</code>:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><code class="language-rust ignore">pub fn run(config: Config) -&gt; Result&lt;(), Box&lt;Error&gt;&gt; {
    let mut f = File::open(config.filename)?;

    let mut contents = String::new();
    f.read_to_string(&amp;mut contents)?;

    for line in search(&amp;config.query, &amp;contents) {
        println!(&quot;{}&quot;, line);
    }

    Ok(())
}
</code></pre>
<p>Ainda estamos usando um loop <code>for</code> para retornar cada linha de <code>search</code> e imprimi-lo.</p>
<p>Agora, todo o programa deve funcionar! Vamos tentar, primeiro, com uma palavra que
deve retornar exatamente uma linha do poema de Emily Dickinson, â€œfrogâ€:</p>
<pre><code class="language-text">$ cargo run frog poem.txt
   Compiling minigrep v0.1.0 (file:///projects/minigrep)
    Finished dev [unoptimized + debuginfo] target(s) in 0.38 secs
     Running `target/debug/minigrep frog poem.txt`
How public, like a frog
</code></pre>
<p>Legal! Agora vamos tentar uma palavra que combine vÃ¡rias linhas, como â€œbodyâ€:</p>
<pre><code class="language-text">$ cargo run body poem.txt
    Finished dev [unoptimized + debuginfo] target(s) in 0.0 secs
     Running `target/debug/minigrep body poem.txt`
Iâ€™m nobody! Who are you?
Are you nobody, too?
How dreary to be somebody!
</code></pre>
<p>E, finalmente, vamos nos certificar de que nÃ£o recebemos nenhuma linha quando buscamos uma
palavra que nÃ£o estÃ¡ em qualquer lugar no poema, como â€œmonomorphizationâ€:</p>
<pre><code class="language-text">$ cargo run monomorphization poem.txt
    Finished dev [unoptimized + debuginfo] target(s) in 0.0 secs
     Running `target/debug/minigrep monomorphization poem.txt`
</code></pre>
<p>Excelente! NÃ³s construÃ­mos nossa prÃ³pria mini versÃ£o de uma ferramenta clÃ¡ssica e aprendemos muito
sobre como estruturar aplicativos. TambÃ©m aprendemos um pouco sobre a entrada de arquivos
e saÃ­da, lifetimes, teste e anÃ¡lise de linha de comando.</p>
<p>Para completar este projeto, brevemente demonstraremos como trabalhar com
variÃ¡veis de ambiente e como imprimir em erro padrÃ£o, ambos
Ãºteis quando vocÃª estÃ¡ escrevendo programas de linha de comando.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="ch12-03-improving-error-handling-and-modularity.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="ch12-05-working-with-environment-variables.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="ch12-03-improving-error-handling-and-modularity.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="ch12-05-working-with-environment-variables.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
